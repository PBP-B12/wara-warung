{% block content %}

<h1>User Dashboard</h1>

<h5>Username: </h5>
<p>{{ username }}</p>

<h5>Password: </h5>
<p>{{ password }}</p>

<h5>Email: </h5>
<p>{{ email }}</p>

<h5>Phone Number: </h5>
<p>{{ phone_number }}</p>

<h5>Address: </h5>
<p>{{ address }}</p>

<h5>Date of Birth: </h5>
<p>{{ date_of_birth }}</p>

<h5>Budget: </h5>
<p>{{ budget }}</p>

<!-- Edit Button to Open a Modal or Directly Edit Info -->
<button id="editInfoButton">Edit Info</button>

<!-- Edit Profile Form (Initially Hidden) -->
<form id="editProfileForm" method="POST" style="display:none;">
    {% csrf_token %}
    <label>Email:</label>
    <input type="email" name="email" value="{{ email }}"><br>

    <label>Phone Number:</label>
    <input type="text" name="phone_number" value="{{ phone_number }}"><br>

    <label>Address:</label>
    <input type="text" name="address" value="{{ address }}"><br>

    <label>Date of Birth:</label>
    <input type="date" name="date_of_birth" value="{{ date_of_birth }}"><br>

    <label>Budget:</label>
    <input type="number" name="budget" value="{{ budget }}"><br>

    <button type="submit">Save Changes</button>
</form>

{% endblock content %}

<!-- JavaScript Section for AJAX -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function() {
        // Show the form when the edit button is clicked
        $('#editInfoButton').on('click', function() {
            $('#editProfileForm').toggle();  // Toggle form visibility
        });

        // AJAX form submission
        $('#editProfileForm').on('submit', function(event) {
            event.preventDefault();  // Prevent the default form submission

            $.ajax({
                type: 'POST',
                url: '/user_dashboard/edit_user/',  // Make sure the URL matches the URL in your view
                data: $(this).serialize(),  // Serialize the form data
                success: function(response) {
                    if (response.success) {
                        alert('Profile updated successfully!');
                        location.reload();  // Reload the page to show updated data
                    } else {
                        alert('Error: ' + response.message);
                    }
                },
                error: function(response) {
                    alert('An error occurred. Please try again.');
                }
            });
        });
    });
</script>
